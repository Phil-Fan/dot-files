# Enable Powerlevel10k instant prompt. Should stay close to the top of ~/.zshrc.
if [[ -r "${XDG_CACHE_HOME:-$HOME/.cache}/p10k-instant-prompt-${(%):-%n}.zsh" ]]; then
  source "${XDG_CACHE_HOME:-$HOME/.cache}/p10k-instant-prompt-${(%):-%n}.zsh"
fi

# =============================================================================
# 模块化 Zsh 配置
# 这个文件会加载 ~/.zsh_config/ 目录下的所有配置模块
# =============================================================================

# Zsh 配置目录
export ZSH_CONFIG_DIR="$HOME/.zsh_config"

# 按顺序加载配置模块
# 1. 环境变量（必须最先加载）
source "$ZSH_CONFIG_DIR/environment.zsh"

# 2. Oh My Zsh 自定义插件（在加载 Oh My Zsh 之前）
if [ -f "$ZSH_CONFIG_DIR/oh-my-zsh-custom-plugins.zsh" ]; then
    source "$ZSH_CONFIG_DIR/oh-my-zsh-custom-plugins.zsh"
fi

# 3. Oh My Zsh（核心框架）
source "$ZSH_CONFIG_DIR/oh-my-zsh.zsh"

# 4. 版本管理器（fnm, rbenv, jenv 等）
source "$ZSH_CONFIG_DIR/version-managers.zsh"

# 4. Conda（Python 环境）
source "$ZSH_CONFIG_DIR/conda.zsh"

# 5. Autojump（目录跳转）
source "$ZSH_CONFIG_DIR/autojump.zsh"

# 6. Bun（JavaScript 运行时）
source "$ZSH_CONFIG_DIR/bun.zsh"

# 7. Antigravity（开发工具）
source "$ZSH_CONFIG_DIR/antigravity.zsh"

# 8. 平台特定配置
{{ if eq .chezmoi.os "darwin" }}
source "$ZSH_CONFIG_DIR/macos.zsh"
{{ else if eq .chezmoi.os "linux" }}
# source "$ZSH_CONFIG_DIR/linux.zsh"
{{ end }}

# 9. 别名定义
source "$ZSH_CONFIG_DIR/aliases.zsh"

# 10. 工具和显示信息
source "$ZSH_CONFIG_DIR/envtools.zsh"

# =============================================================================
# 自动补全初始化
# =============================================================================
autoload -U compinit && compinit -u
