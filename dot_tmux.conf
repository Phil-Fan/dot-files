# =============================================================================
# Tmux é…ç½® - PhilFan
# æ”¯æŒ tmux 3.6+
# =============================================================================

# -----------------------------------------------------------------------------
# åŸºç¡€è®¾ç½®
# -----------------------------------------------------------------------------
# ä¿æŒé»˜è®¤ prefix é”® Ctrl+b
# set-option -g prefix C-b

# å¯ç”¨é¼ æ ‡æ“ä½œï¼ˆå¯ç‚¹å‡»çª—å£ã€é¢æ¿ã€æ‹–æ‹½è°ƒæ•´å¤§å°ï¼‰
set -g mouse on

# å¯ç”¨ 256 è‰²æ”¯æŒ
set -g default-terminal "screen-256color"

# å¯ç”¨çœŸå½©è‰²æ”¯æŒ
set -ga terminal-overrides ",xterm-256color:Tc"

# çŠ¶æ€æ åˆ·æ–°é—´éš”ï¼ˆç§’ï¼‰
set -g status-interval 1

# æ‰©å±•æ˜¾ç¤ºå†å²é™åˆ¶
set -g history-limit 100000

# çª—å£å’Œé¢æ¿ç´¢å¼•ä» 1 å¼€å§‹ï¼ˆæ›´ç¬¦åˆé”®ç›˜å¸ƒå±€ï¼‰
set -g base-index 1
setw -g pane-base-index 1

# é‡æ–°ç¼–å·çª—å£æ—¶å…³é—­é—´éš™
set -g renumber-windows on

# é˜²æ­¢è‡ªåŠ¨é‡å‘½åçª—å£ï¼ˆä¿æŒè‡ªå®šä¹‰åç§°ï¼‰
set-option -g allow-rename off

# -----------------------------------------------------------------------------
# é”®ç»‘å®š
# -----------------------------------------------------------------------------
# ä½¿ç”¨ r heload é…ç½®ï¼ˆç®€åŒ–ç‰ˆï¼Œæ— éœ€ prefixï¼‰
bind-key r source-file ~/.tmux.conf \; display-message "âœ… é…ç½®å·²é‡æ–°åŠ è½½"

# æ›´ç›´è§‚çš„çª—å£åˆ†å‰²å¿«æ·é”®ï¼ˆ\ æ°´å¹³ï¼Œ- å‚ç›´ï¼‰
bind-key | split-window -h
bind-key - split-window -v
unbind '"'
unbind %

# å¿«é€Ÿåˆ‡æ¢é¢æ¿ - Alt+ç®­å¤´ï¼ˆæ— éœ€ prefixï¼Œæœ€ç›´è§‚ï¼‰
bind-key -n M-Left select-pane -L
bind-key -n M-Right select-pane -R
bind-key -n M-Up select-pane -U
bind-key -n M-Down select-pane -D

# å¿«é€Ÿåˆ‡æ¢é¢æ¿ - Alt+hjklï¼ˆVim é£æ ¼ï¼Œæ— éœ€ prefixï¼‰
bind-key -n M-h select-pane -L
bind-key -n M-j select-pane -D
bind-key -n M-k select-pane -U
bind-key -n M-l select-pane -R

# ä½¿ç”¨ Alt+Shift+HJKL è°ƒæ•´é¢æ¿å¤§å°
bind-key -n M-H resize-pane -L 5
bind-key -n M-J resize-pane -D 5
bind-key -n M-K resize-pane -U 5
bind-key -n M-L resize-pane -R 5

# ä½¿ç”¨ Ctrl+hjkl åˆ‡æ¢çª—å£
bind-key -n C-h select-window -t :-
bind-key -n C-l select-window -t :+

# ä½¿ç”¨ Alt+æ•°å­—ç›´æ¥åˆ‡æ¢çª—å£
bind-key -n M-1 select-window -t 1
bind-key -n M-2 select-window -t 2
bind-key -n M-3 select-window -t 3
bind-key -n M-4 select-window -t 4
bind-key -n M-5 select-window -t 5
bind-key -n M-6 select-window -t 6
bind-key -n M-7 select-window -t 7
bind-key -n M-8 select-window -t 8
bind-key -n M-9 select-window -t 9

# å¿«é€Ÿåˆ‡æ¢é¢æ¿
bind-key Tab last-pane
bind-key bspace previous-window
bind-key space next-window

# å¤åˆ¶/ç²˜è´´æ¨¡å¼ä½¿ç”¨ vi é”®ä½
setw -g mode-keys vi

# -----------------------------------------------------------------------------
# çŠ¶æ€æ å¤–è§‚
# -----------------------------------------------------------------------------
# çŠ¶æ€æ ä½ç½®
set -g status-position bottom

# çŠ¶æ€æ å¯¹é½
set -g status-justify left

# çŠ¶æ€æ èƒŒæ™¯å’Œå‰æ™¯è‰²
set -g status-style 'bg=#1e1e2e fg=#ffffff'

# å·¦ä¾§çŠ¶æ€æ 
set -g status-left-length 100
set -g status-left-style 'bg=#1e1e2e fg=#61afef'
set -g status-left ' #[fg=#61afef,bold]#S#[fg=#ffffff] #[fg=#ffffff]#{session_name} '

# å³ä¾§çŠ¶æ€æ 
set -g status-right-length 100
set -g status-right-style 'bg=#1e1e2e fg=#98c379'
set -g status-right ' #[fg=#98c379]#{?pane_synchronized,ğŸ”´,} #[fg=#ffffff]%H:%M:%S #[fg=#98c379]%Y-%m-%d '

# çª—å£åˆ—è¡¨æ ¼å¼
setw -g window-status-format ' #[fg=#5c6370]#I#[fg=#ffffff] #W#[fg=#5c6370]#F '
setw -g window-status-current-format ' #[fg=#e5c07b,bold]#I#[fg=#ffffff,bold] #W#[fg=#e5c07b]#F '
setw -g window-status-last-style 'fg=#61afef'
setw -g window-status-bell-style 'fg=#e06c75,bold'

# é¢æ¿è¾¹æ¡†æ ·å¼
set -g pane-border-style 'fg=#3b4261 bg=#1e1e2e'
set -g pane-active-border-style 'fg=#61afef bg=#1e1e2e'

# æ¶ˆæ¯æç¤ºæ ·å¼
set -g message-style 'fg=#61afef bg=#1e1e2e bold'
set -g message-command-style 'fg=#98c379 bg=#1e1e2e'

# -----------------------------------------------------------------------------
# é¢æ¿è¡Œä¸º
# -----------------------------------------------------------------------------
# æ–°çª—å£ä¿æŒåœ¨å½“å‰è·¯å¾„ï¼ˆå¯ç”¨å½“å‰è·¯å¾„ï¼‰
bind-key c new-window -c "#{pane_current_path}"

# åŒæ­¥è¾“å…¥ï¼ˆæ‰€æœ‰é¢æ¿åŒæ­¥è¾“å…¥ï¼‰
bind-key * setw synchronize-panes

# -----------------------------------------------------------------------------
# ç¼–è¾‘å™¨é›†æˆ
# -----------------------------------------------------------------------------
# ä½¿ç”¨ $EDITOR æ‰“å¼€ scrollback buffer
bind-key e copy-mode -u \; send-keys -X begin-selection \; send-keys -X rectangle-toggle \; send-keys -X cursor-at-top \; run-shell 'EDITOR=vim tmux show-buffer | $EDITOR -'

# -----------------------------------------------------------------------------
# æ€§èƒ½ä¼˜åŒ–
# -----------------------------------------------------------------------------
# å‡å°‘è½¬ä¹‰åºåˆ—å»¶è¿Ÿ
set -sg escape-time 10

# å¢åŠ  scrollback ç¼“å†²åŒºï¼ˆå·²åœ¨ä¸Šé¢è®¾ç½® history-limitï¼‰

# -----------------------------------------------------------------------------
# æœç´¢å’Œå¤åˆ¶
# -----------------------------------------------------------------------------
# Vi é£æ ¼å¤åˆ¶æ¨¡å¼é”®ä½
bind-key -T copy-mode-vi v send-keys -X begin-selection
bind-key -T copy-mode-vi y send-keys -X copy-pipe-and-cancel "pbcopy"
bind-key -T copy-mode-vi r send-keys -X rectangle-toggle
bind-key -T copy-mode-vi C-v send-keys -X page-down
bind-key -T copy-mode-vi M-v send-keys -X page-up

# é¼ æ ‡å¤åˆ¶åˆ°ç³»ç»Ÿå‰ªè´´æ¿
bind-key -T copy-mode-vi MouseDragEnd1Pane send-keys -X copy-pipe-no-clear "pbcopy"
bind-key -T copy-mode-vi DoubleClick1Pane send-keys -X select-word \; run-shell "tmux send-keys -X copy-pipe-and-cancel pbcopy"
bind-key -T copy-mode-vi TripleClick1Pane send-keys -X select-line \; run-shell "tmux send-keys -X copy-pipe-and-cancel pbcopy"

# -----------------------------------------------------------------------------
# ä¼šè¯ç®¡ç†
# -----------------------------------------------------------------------------
# ä¿å­˜ä¼šè¯åˆ—è¡¨ï¼ˆå¯é€‰ï¼Œéœ€è¦æ’ä»¶ï¼‰
# set -g @continuum-save 'on'
# set -g @continuum-restore 'on'
